(()=>{"use strict";var e={452:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadState=function(){chrome.storage.sync.get([r.STORAGE_KEYS.PERSIAN_INPUT,r.STORAGE_KEYS.FONT_INJECTION_ENABLED,r.STORAGE_KEYS.SELECTED_FONT],(e=>{n.persianToggle.checked=!!e[r.STORAGE_KEYS.PERSIAN_INPUT],n.fontToggle.checked=!!e[r.STORAGE_KEYS.FONT_INJECTION_ENABLED],e[r.STORAGE_KEYS.FONT_INJECTION_ENABLED]?n.fontSelectorContainer.classList.add("visible"):n.fontSelectorContainer.classList.remove("visible"),e[r.STORAGE_KEYS.SELECTED_FONT]&&(n.fontSelector.value=e[r.STORAGE_KEYS.SELECTED_FONT]),e[r.STORAGE_KEYS.PERSIAN_INPUT]&&(0,E.checkForErrors)()}))};const n=o(499),E=o(968),r=o(554)},499:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.statusEl=t.fontAuthor=t.fontSelector=t.fontSelectorContainer=t.errorMessageEl=t.resetButton=t.fontToggle=t.persianToggle=void 0,t.initFontSelector=function(){t.fontSelector.innerHTML="",n.DEFAULT_FONTS.forEach((e=>{const o=document.createElement("option");o.value=e.en_name,o.textContent=e.fa_name,o.dataset.author=e.creator,t.fontSelector.appendChild(o)}))},t.updateFontAuthor=function(){const e=t.fontSelector.options[t.fontSelector.selectedIndex];t.fontAuthor.textContent=(null==e?void 0:e.dataset.author)?`By: ${e.dataset.author}`:""},t.updateStatus=function(e){t.statusEl&&(t.statusEl.textContent=e)},t.showErrorMessage=function(e){t.errorMessageEl.style.display="block",t.errorMessageEl.innerHTML=`\n    <p>‚ö†Ô∏è ${e} conversion errors detected!</p>\n    <p>Some dates might be displaying incorrectly. Try the "Reset All Dates" button to fix.</p>\n  `};const n=o(554);t.persianToggle=document.getElementById(n.UI_ELEMENTS.PERSIAN_TOGGLE),t.fontToggle=document.getElementById(n.UI_ELEMENTS.FONT_TOGGLE),t.resetButton=document.getElementById(n.UI_ELEMENTS.RESET_BUTTON),t.errorMessageEl=document.getElementById(n.UI_ELEMENTS.ERROR_MESSAGE),t.fontSelectorContainer=document.getElementById(n.UI_ELEMENTS.FONT_SELECTOR_CONTAINER),t.fontSelector=document.getElementById(n.UI_ELEMENTS.FONT_SELECTOR),t.fontAuthor=document.getElementById(n.UI_ELEMENTS.FONT_AUTHOR),t.statusEl=document.getElementById(n.UI_ELEMENTS.STATUS)},554:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HTML_CONSTANTS=t.SELECTOR_DATE_PICKER_INPUT=t.SELECTOR_PROPERTY_VALUE=t.SELECTOR_DATE_MENTION=t.SELECTOR_DATE_FORMAT_CLEAR=t.SELECTOR_NEXT_MONTH=t.SELECTOR_PREV_MONTH=t.SELECTOR_DATE_BUTTONS=t.NOTION_URL_PATTERN=t.DEBOUNCE_DELAY=t.MESSAGE_TYPES=t.UI_ELEMENTS=t.STORAGE_KEYS=t.SELECTOR_REMINDERS=t.DATASET_KEYS=t.SYSTEM_FONTS=t.DEFAULT_FONT=t.SELECTOR_GLOBAL_FONTS=t.SELECTOR_RTL_ELEMENTS=t.SELECTOR_TODO_BLOCK=t.SELECTOR_TABLE_BLOCK=t.SELECTOR_BULLETED_LIST=t.SELECTOR_TOGGLE_BLOCK=t.SELECTOR_QUOTE_BLOCK=t.SELECTOR_NUMBERED_LIST=t.SELECTOR_CODE_BLOCK=t.SELECTOR_EDITABLE_TEXT=t.ALL_FONTS_CSS=t.DEFAULT_FONTS=t.UNICODE_RANGE=t.PANEL_STATE_KEY=t.SELECTOR_MENTIONS=t.CLICK_INSTRUCTION=t.NO_DATES_MESSAGE=t.PANEL_TITLE=t.TOAST_ID=t.SHOW_BTN_ID=t.HIDE_BTN_ID=t.MINIMIZE_BTN_ID=t.CONTENT_ID=t.PANEL_ID=t.SELECTOR_TABLE_DATES=t.TIME_THRESHOLD_MS=t.STANDARD_DATE_FORMAT=t.PERSIAN_MONTHS=t.MONTHS=t.LOG_PREFIX=void 0,t.LOG_PREFIX="mtlog:",t.MONTHS={january:1,february:2,march:3,april:4,may:5,june:6,july:7,august:8,september:9,october:10,november:11,december:12,jan:1,feb:2,mar:3,apr:4,jun:6,jul:7,aug:8,sep:9,sept:9,oct:10,nov:11,dec:12},t.PERSIAN_MONTHS=["ŸÅÿ±Ÿàÿ±ÿØ€åŸÜ","ÿßÿ±ÿØ€åÿ®Ÿáÿ¥ÿ™","ÿÆÿ±ÿØÿßÿØ","ÿ™€åÿ±","ŸÖÿ±ÿØÿßÿØ","ÿ¥Ÿáÿ±€åŸàÿ±","ŸÖŸáÿ±","ÿ¢ÿ®ÿßŸÜ","ÿ¢ÿ∞ÿ±","ÿØ€å","ÿ®ŸáŸÖŸÜ","ÿßÿ≥ŸÅŸÜÿØ"],t.STANDARD_DATE_FORMAT=/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/,t.TIME_THRESHOLD_MS=500,t.SELECTOR_TABLE_DATES="[data-testid='property-value'] div, div.notion-date",t.PANEL_ID="persian-dates-panel",t.CONTENT_ID="persian-dates-content",t.MINIMIZE_BTN_ID="persian-dates-minimize",t.HIDE_BTN_ID="persian-dates-hide",t.SHOW_BTN_ID="persian-dates-show-button",t.TOAST_ID="persian-dates-toast",t.PANEL_TITLE="Persian Dates",t.NO_DATES_MESSAGE="No date mentions found.",t.CLICK_INSTRUCTION="Click a date to copy Persian format or scroll to its location",t.SELECTOR_MENTIONS=".notion-text-mention-token .notion-reminder",t.PANEL_STATE_KEY="persian-dates-panel-state",t.UNICODE_RANGE="U+0600-06FF, U+0750-077F, U+FB50-FDFF, U+FE70-FEFF",t.DEFAULT_FONTS=[{en_name:"Vazirmatn",fa_name:"Ÿàÿ≤€åÿ± ŸÖÿ™ŸÜ",creator:"ÿµÿßÿ®ÿ± ÿ±ÿßÿ≥ÿ™€å ⁄©ÿ±ÿØÿßÿ±"},{en_name:"Sahel",fa_name:"ÿ≥ÿßÿ≠ŸÑ",creator:"ÿµÿßÿ®ÿ± ÿ±ÿßÿ≥ÿ™€å ⁄©ÿ±ÿØÿßÿ±"},{en_name:"Parastoo",fa_name:"Ÿæÿ±ÿ≥ÿ™Ÿà",creator:"ÿµÿßÿ®ÿ± ÿ±ÿßÿ≥ÿ™€å ⁄©ÿ±ÿØÿßÿ±"}],t.ALL_FONTS_CSS=`\n/* ========== Vazirmatn ========== */\n@font-face {\n  font-family: "Vazirmatn";\n  src:\n    url("${chrome.runtime.getURL("assets/fonts/vazir/Vazirmatn[wght].woff2")}")\n      format("woff2 supports variations"),\n    url("${chrome.runtime.getURL("assets/fonts/vazir/Vazirmatn[wght].woff2")}")\n      format("woff2-variations");\n  font-weight: 100 900;\n  font-style: normal;\n  font-display: swap;\n  unicode-range: ${t.UNICODE_RANGE};\n}\n\n/* ========== Sahel ========== */\n@font-face {\n  font-family: "Sahel";\n  src:\n    url("${chrome.runtime.getURL("assets/fonts/sahel/Sahel-VF.woff2")}")\n      format("woff2 supports variations"),\n    url("${chrome.runtime.getURL("assets/fonts/sahel/Sahel-VF.woff2")}")\n      format("woff2-variations");\n  font-weight: 100 900;\n  font-style: normal;\n  font-display: swap;\n  unicode-range: ${t.UNICODE_RANGE};\n}\n\n/* ========== Parastoo ========== */\n@font-face {\n  font-family: "Parastoo";\n  src: url("${chrome.runtime.getURL("assets/fonts/parastoo/Parastoo.woff2")}") format("woff2");\n  font-weight: normal;\n  font-style: normal;\n  unicode-range: ${t.UNICODE_RANGE};\n}\n@font-face {\n  font-family: "Parastoo";\n  src: url("${chrome.runtime.getURL("assets/fonts/parastoo/Parastoo-Bold.woff2")}")\n    format("woff2");\n  font-weight: bold;\n  font-style: normal;\n  unicode-range: ${t.UNICODE_RANGE};\n}\n\n/* Keep code blocks in LTR */\n.notion-text-content[data-content-type="code"] {\n  direction: ltr !important;\n  text-align: left !important;\n  font-family: "SF Mono", "Consolas", "Monaco", "Andale Mono", monospace !important;\n}\n`,t.SELECTOR_EDITABLE_TEXT='.notranslate[data-content-editable-leaf="true"]',t.SELECTOR_CODE_BLOCK='[data-content-type="code"]',t.SELECTOR_NUMBERED_LIST=".notion-selectable.notion-numbered_list-block",t.SELECTOR_QUOTE_BLOCK=".notion-quote-block",t.SELECTOR_TOGGLE_BLOCK=".notion-selectable.notion-toggle-block",t.SELECTOR_BULLETED_LIST=".notion-selectable.notion-bulleted_list-block",t.SELECTOR_TABLE_BLOCK=".notion-table-block",t.SELECTOR_TODO_BLOCK=".notion-to_do-block",t.SELECTOR_RTL_ELEMENTS='.notion-body h1, .notion-body h2, .notion-body h3, .notion-body h4, .notion-body h5, .notion-body h6, .notion-table-view th, .notion-table-view td, .notion-collection_view-block div[data-content-editable-void="true"] > div:nth-child(2), .notion-table-view-header-cell, .notion-table-view-cell',t.SELECTOR_GLOBAL_FONTS=[".notion-page-content",".notion-table-view",".notion-board-view",".notion-gallery-view",".notion-page-block",".notion-topbar",".notion-body",".notion-selectable",".notion-collection_view-block",".notion-frame",".notion-collection-item"].join(", "),t.DEFAULT_FONT="Vazirmatn",t.SYSTEM_FONTS='-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, sans-serif',t.DATASET_KEYS={ORIGINAL_DATE:"originalDate",CONVERTED:"converted"},t.SELECTOR_REMINDERS=".notion-reminder",t.STORAGE_KEYS={PERSIAN_INPUT:"persianInput",FONT_INJECTION_ENABLED:"fontInjectionEnabled",SELECTED_FONT:"selectedFont",PERSIAN_NUMBERS:"persianNumbers"},t.UI_ELEMENTS={PERSIAN_TOGGLE:"persian-toggle",FONT_TOGGLE:"font-toggle",RESET_BUTTON:"reset-button",ERROR_MESSAGE:"error-message",FONT_SELECTOR_CONTAINER:"font-selector-container",FONT_SELECTOR:"font-selector",FONT_AUTHOR:"font-author",STATUS:"status",CALL_MESSAGE:"call-message"},t.MESSAGE_TYPES={APPLY_SETTINGS:"applySettings",RESET_COMPLETE:"resetComplete",ERROR_COUNT_CHANGED:"errorCountChanged",CHECK_ERRORS:"checkErrors",REFRESH_CONVERSION:"refreshConversion"},t.DEBOUNCE_DELAY=300,t.NOTION_URL_PATTERN="*://*.notion.so/*",t.SELECTOR_DATE_BUTTONS='button[name="day"]',t.SELECTOR_PREV_MONTH='button[name="previous-month"]',t.SELECTOR_NEXT_MONTH='button[name="next-month"]',t.SELECTOR_DATE_FORMAT_CLEAR='[role="button"]',t.SELECTOR_DATE_MENTION=".notion-selectable",t.SELECTOR_PROPERTY_VALUE='[data-testid="property-value"]',t.SELECTOR_DATE_PICKER_INPUT=".rdp",t.HTML_CONSTANTS={TITLE:"ŸÜŸàÿ¥ŸÜ ŸÅÿßÿ±ÿ≥€å",HEADER_TEXT:"ŸÜŸàÿ¥ŸÜ ŸÅÿßÿ±ÿ≥€å",CALENDAR_LABEL:"ÿ™ÿßÿ±€åÿÆ ÿ¥ŸÖÿ≥€å",FONT_LABEL:"ŸÅŸàŸÜÿ™ ŸÅÿßÿ±ÿ≥€å",CALL_MESSAGE:"ÿß⁄ØŸá ⁄Ü€åÿ≤€å ÿÆÿ±ÿßÿ® ÿ®ŸàÿØÿå €åŸá ÿÆÿ®ÿ± ÿ®ŸáŸÖ ÿ®ÿØŸá  üêû",FOOTER_NAME:"Matthew Truth"}},670:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveSelectedFont=function(e){return new Promise((t=>{chrome.storage.sync.set({[n.STORAGE_KEYS.SELECTED_FONT]:e},(()=>t()))}))},t.loadSelectedFont=u,t.setCurrentFont=function(e){l=e,E&&document.querySelectorAll(n.SELECTOR_EDITABLE_TEXT).forEach((e=>{const t=e;s(t.textContent||"")&&(t.style.fontFamily=`${l}, ${n.SYSTEM_FONTS}`)}));L(),O(),c(),S(),_()},t.injectFonts=function(e){e?u().then((e=>{l=e,E||(E=document.createElement("style"),E.textContent=n.ALL_FONTS_CSS,document.head.appendChild(E)),function(){if(r)return;r=new MutationObserver((e=>{for(const t of e)"childList"===t.type?t.addedNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&i(e)})):"characterData"===t.type&&a(t.target);d(),L(),O(),c(),S(),_()})),r.observe(document.body,{childList:!0,subtree:!0,characterData:!0}),i(document.body),d(),L(),O(),c(),S(),_()}()})):(E&&(E.remove(),E=null),document.querySelectorAll(n.SELECTOR_EDITABLE_TEXT).forEach((e=>{const t=e;t.style.fontFamily="",t.style.direction="",t.style.textAlign=""})),document.querySelectorAll(n.SELECTOR_GLOBAL_FONTS).forEach((e=>{e.style.removeProperty("font-family")})),document.querySelectorAll(n.SELECTOR_RTL_ELEMENTS).forEach((e=>{const t=e;t.style.direction="",t.style.textAlign="",t.style.fontFamily=""})),document.querySelectorAll(n.SELECTOR_NUMBERED_LIST).forEach((e=>{e.style.direction="",e.style.textAlign="";const t=e.querySelector(".pseudoBefore");t&&(t.style.direction="",t.style.textAlign="")})),document.querySelectorAll(n.SELECTOR_QUOTE_BLOCK).forEach((e=>{const t=e.querySelector("blockquote");if(t){const e=t.querySelector("div[style*='border-right']");e&&(e.style.borderRight="none",e.style.borderLeft="3px solid currentcolor",e.style.paddingLeft="",e.style.paddingRight=""),t.style.direction="",t.style.textAlign=""}})),document.querySelectorAll(n.SELECTOR_TOGGLE_BLOCK).forEach((e=>{const t=e;t.style.textAlign="";const o=t.firstElementChild;o&&o.style.removeProperty("flex-direction")})),document.querySelectorAll(`${n.SELECTOR_BULLETED_LIST}, ${n.SELECTOR_TABLE_BLOCK}, ${n.SELECTOR_TODO_BLOCK}`).forEach((e=>{e.removeAttribute("dir")})),r&&(r.disconnect(),r=null))};const n=o(554);let E=null,r=null,l=n.DEFAULT_FONT;function s(e){return/[\u0600-\u06FF\u0750-\u077F\uFB50-\uFDFF\uFE70-\uFEFF]/.test(e)}function a(e){var t;if(!s(e.textContent||""))return;const o=null===(t=e.parentElement)||void 0===t?void 0:t.closest(n.SELECTOR_EDITABLE_TEXT);o&&!o.closest(n.SELECTOR_CODE_BLOCK)&&(o.style.fontFamily=`${l}, ${n.SYSTEM_FONTS}`,o.style.direction="rtl",o.style.textAlign="right")}function i(e){const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let o;for(;o=t.nextNode();)a(o)}function T(e){const t=e.querySelector(".pseudoBefore");if(t){let e=t.style.getPropertyValue("--pseudoBefore--content")||t.textContent||"";e=e.replace(/["']/g,"").trim();const o=e.replace(/\d/g,(e=>"€∞€±€≤€≥€¥€µ€∂€∑€∏€π"[parseInt(e)]));t.style.removeProperty("--pseudoBefore--content"),t.textContent=o,t.style.direction="rtl",t.style.textAlign="right"}}function c(){document.querySelectorAll(n.SELECTOR_NUMBERED_LIST).forEach((e=>{s(e.textContent||"")&&(T(e),e.style.direction="rtl",e.style.textAlign="right")}))}function S(){document.querySelectorAll(n.SELECTOR_QUOTE_BLOCK).forEach((e=>{if(s(e.textContent||"")){const t=e.querySelector("blockquote");if(t){const e=t.querySelector("div[style*='border-left']");if(e){const t=window.getComputedStyle(e),o=t.paddingLeft,n=t.paddingRight;e.style.borderLeft="none",e.style.borderRight="3px solid currentcolor",e.style.paddingLeft=n,e.style.paddingRight=o}t.style.direction="rtl",t.style.textAlign="right"}}}))}function _(){document.querySelectorAll(n.SELECTOR_TOGGLE_BLOCK).forEach((e=>{if(s(e.textContent||"")){const t=e;t.style.textAlign="right";const o=t.firstElementChild;o&&o.style.setProperty("flex-direction","row-reverse","important")}}))}function d(){document.querySelectorAll(n.SELECTOR_BULLETED_LIST).forEach((e=>{e.setAttribute("dir","rtl")})),document.querySelectorAll(n.SELECTOR_TABLE_BLOCK).forEach((e=>{Array.from(e.querySelectorAll("*")).some((e=>s(e.textContent||"")))&&e.setAttribute("dir","rtl")})),document.querySelectorAll(n.SELECTOR_TODO_BLOCK).forEach((e=>{Array.from(e.querySelectorAll("*")).some((e=>s(e.textContent||"")))&&e.setAttribute("dir","rtl")}))}function O(){document.querySelectorAll(n.SELECTOR_RTL_ELEMENTS).forEach((e=>{if(s(e.textContent||"")){const t=e;t.style.direction="rtl",t.style.textAlign="right",t.style.fontFamily=`${l}, ${n.SYSTEM_FONTS}`}}))}function L(){document.querySelectorAll(n.SELECTOR_GLOBAL_FONTS).forEach((e=>{e.style.setProperty("font-family",`${l}, ${n.SYSTEM_FONTS}`,"important")}))}function u(){return new Promise((e=>{chrome.storage.sync.get([n.STORAGE_KEYS.SELECTED_FONT],(t=>e(t[n.STORAGE_KEYS.SELECTED_FONT]||n.DEFAULT_FONT)))}))}},968:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initListeners=function(){n.persianToggle.addEventListener("change",(()=>{const e=n.persianToggle.checked;chrome.storage.sync.set({[r.STORAGE_KEYS.PERSIAN_INPUT]:e}),chrome.tabs.query({active:!0,currentWindow:!0},(t=>{var o;(null===(o=t[0])||void 0===o?void 0:o.id)&&chrome.tabs.sendMessage(t[0].id,{persianInput:e})})),e?setTimeout(s,1e3):n.errorMessageEl.style.display="none"})),n.fontToggle.addEventListener("change",(()=>{const e=n.fontToggle.checked;chrome.storage.sync.set({[r.STORAGE_KEYS.FONT_INJECTION_ENABLED]:e}),e?n.fontSelectorContainer.classList.add("visible"):n.fontSelectorContainer.classList.remove("visible"),chrome.tabs.query({active:!0,currentWindow:!0},(t=>{var o;(null===(o=t[0])||void 0===o?void 0:o.id)&&chrome.tabs.sendMessage(t[0].id,{fontInjectionEnabled:e})}))})),n.fontSelector.addEventListener("change",(()=>{const e=n.fontSelector.value;(0,E.saveSelectedFont)(e).then((()=>{chrome.tabs.query({active:!0,currentWindow:!0},(t=>{var o;(null===(o=t[0])||void 0===o?void 0:o.id)&&chrome.tabs.sendMessage(t[0].id,{selectedFont:e})}))}))})),document.addEventListener("keydown",(e=>{"Alt"===e.key&&(l=!0,n.resetButton.textContent="Force Reload Page")})),document.addEventListener("keyup",(e=>{"Alt"===e.key&&(l=!1,n.resetButton.textContent="Reset All Dates")})),chrome.runtime.onMessage.addListener((e=>{e[r.MESSAGE_TYPES.RESET_COMPLETE]&&(e.reloading||(n.resetButton.disabled=!1,setTimeout(s,500))),void 0!==e[r.MESSAGE_TYPES.ERROR_COUNT_CHANGED]&&(e.errorCount>0?(0,n.showErrorMessage)(e.errorCount):n.errorMessageEl.style.display="none")}))},t.checkForErrors=s;const n=o(499),E=o(670),r=o(554);let l=!1;function s(){chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var t;(null===(t=e[0])||void 0===t?void 0:t.id)&&chrome.tabs.sendMessage(e[0].id,{[r.MESSAGE_TYPES.CHECK_ERRORS]:!0},(e=>{chrome.runtime.lastError||(e&&e.errorCount>0?(0,n.showErrorMessage)(e.errorCount):n.errorMessageEl.style.display="none")}))}))}}},t={};function o(n){var E=t[n];if(void 0!==E)return E.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(()=>{const e=o(499),t=o(968),n=o(452),E=o(554);(0,e.initFontSelector)(),(0,n.loadState)(),(0,t.initListeners)();const r=document.getElementById("settings-gear"),l=document.getElementById("main-page"),s=document.getElementById("settings-page"),a=document.getElementById("settings-back"),i=document.getElementById("persian-numbers-toggle");chrome.storage.sync.get([E.STORAGE_KEYS.PERSIAN_NUMBERS],(e=>{i.checked=!!e[E.STORAGE_KEYS.PERSIAN_NUMBERS]})),i.addEventListener("change",(()=>{chrome.storage.sync.set({[E.STORAGE_KEYS.PERSIAN_NUMBERS]:i.checked},(()=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var t;(null===(t=e[0])||void 0===t?void 0:t.id)&&chrome.tabs.sendMessage(e[0].id,{type:E.MESSAGE_TYPES.REFRESH_CONVERSION})}))}))})),r.addEventListener("click",(()=>{l.style.display="none",s.style.display="block"})),a.addEventListener("click",(()=>{s.style.display="none",l.style.display="block"}))})()})();
//# sourceMappingURL=popup.js.map